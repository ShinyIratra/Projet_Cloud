<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Test Carte Antananarivo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        #map {
            height: 600px;
            width: 100%;
        }
        .info {
            background: white;
            padding: 10px;
            margin: 10px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>
    <div class="info">
        <h2>Test Module Carte - Antananarivo</h2>
        <p><strong>√âtat :</strong> ‚úÖ Serveur de tuiles local OFFLINE op√©rationnel (localhost:8080)</p>
        <p><strong>Coordonn√©es :</strong> -18.8792, 47.5079 (Centre d'Antananarivo)</p>
        <p><strong>‚ö†Ô∏è Important :</strong> Ouvrir via <code>http://localhost:3000/test-carte.html</code> (pas file://)</p>
        <p><strong>Commande :</strong> <code>python -m http.server 3000</code></p>
    </div>
    
    <div id="map"></div>

    <div class="info">
        <h3>Fonctionnalit√©s test√©es :</h3>
        <ul>
            <li>‚úÖ Affichage carte Leaflet</li>
            <li>‚úÖ Centrage sur Antananarivo</li>
            <li>‚úÖ Navigation (zoom, d√©placement)</li>
            <li>üîÑ Points de signalement (√† impl√©menter)</li>
            <li>‚úÖ Serveur tiles local Docker</li>
        </ul>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Initialisation de la carte centr√©e sur Antananarivo
        // Zoom 10 au lieu de 13 pour tester plus rapidement (moins de tuiles)
        const map = L.map('map').setView([-18.8792, 47.5079], 10);

        // Couche de tiles depuis serveur local Docker
        L.tileLayer('http://localhost:8080/tile/{z}/{x}/{y}.png', {
            attribution: '¬© OpenStreetMap contributors | Serveur local Docker',
            maxZoom: 18,
            timeout: 30000  // 30 secondes pour laisser le temps de g√©n√©rer les tuiles
        }).addTo(map);

        // Marqueur test pour le centre d'Antananarivo
        L.marker([-18.8792, 47.5079])
            .addTo(map)
            .bindPopup('<strong>Antananarivo Centre</strong><br>Test de g√©olocalisation')
            .openPopup();

        // Exemple de point de signalement (simulation)
        L.marker([-18.8650, 47.5200])
            .addTo(map)
            .bindPopup(`
                <strong>Probl√®me routier #001</strong><br>
                <strong>Date :</strong> 19/01/2026<br>
                <strong>Status :</strong> Nouveau<br>
                <strong>Surface :</strong> 25 m¬≤<br>
                <strong>Budget :</strong> 50 000 Ar<br>
                <strong>Entreprise :</strong> Travaux Publics SA
            `);

        // Zone de test pour les fonctionnalit√©s futures
        console.log('Carte initialis√©e avec succ√®s');
        console.log('Centre:', map.getCenter());
        console.log('Zoom:', map.getZoom());
    </script>
</body>
</html>